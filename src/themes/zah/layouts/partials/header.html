{{ $js := resources.Get "js/index.js" }}
{{ $sourceMap := cond hugo.IsProduction "" "" }}
{{ $params := dict }}
{{ $opts := dict "sourceMap" $sourceMap "minify" hugo.IsProduction "target" "es2018" "params" $params }}
{{ $js = $js | js.Build $opts }}
{{ if hugo.IsProduction }}
  {{ $js = $js | fingerprint }}
{{ end }}

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="author" content="Andrew Zah - {{ .Site.BaseURL }}">
  <meta name="description" content="{{ if ne .Description "" }}{{ .Description }}{{ else }}{{ .Site.Params.description }}{{ end }}">
  <meta name="fediverse:creator" content="@andrewzah@fosstodon.org">

  <link rel="canonical" href="{{ .Permalink | absURL }}">
  <link rel="alternate"
    type="application/rss+xml"
    href="{{.Site.BaseURL }}/posts/index.xml"
    title="{{ .Site.Title }}">

  {{ block "title" . -}}
    {{- if .IsHome -}}
      <title> Andrew Zah | 자준재 </title>
    {{- else -}}
      <title>{{ .Title }} | {{ $.Site.Title }}</title>
    {{- end -}}
  {{- end -}}

  {{ template "_internal/opengraph.html" . }}
  {{ template "_internal/schema.html" . }}
  {{ template "_internal/twitter_cards.html" . }}

  {{ $styles := resources.Get "scss/main.scss" | toCSS (dict "outputStyle" "compressed") | minify }}
  <style>{{ $styles.Content | safeCSS }}</style>
</head>
